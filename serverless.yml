service: express-ahorro
useDotenv: true
custom:
  webpack:
    webpackConfig: ./webpack.config.js
    includeModules: true
plugins:
  - serverless-webpack
  - serverless-offline
provider:
  name: aws
  runtime: nodejs14.x
  region: ap-southeast-1
  apiGateway:
    minimumCompressionSize: 1024
    shouldStartNameWithService: true
  environment:
    AWS_NODEJS_CONNECTION_REUSE_ENABLED: 1
package:
  individually: true
functions:
  express:
    handler: dist/src/server.handler
    events:
      - http:
          method: ANY
          path: /
      - http:
          method: GET
          path: /entries
      - http:
          method: POST
          path: /entries/sync
      - http:
          method: GET
          path: /entries/sync/callback
      - http:
          method: GET
          path: /entries/monthly
      - http:
          method: POST
          path: /auth/login/{type}
      - http:
          method: POST
          path: /auth/login
      - http:
          method: GET
          path: /auth/callback/{type}
      - http:
          method: POST
          path: /auth/refresh
      - http:
          method: POST
          path: /auth/logout